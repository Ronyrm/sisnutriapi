{% extends "layouts/atleta/baseatleta.html" %}
{% block result %} {{ result }} {% endblock %}
{% block mensagem %} {{ mensagem }} {% endblock %}
{% block tela %} {{ tela }} {% endblock %}
{% block atletalogado %} {{ atletalogado }} {% endblock %}
{% block refeicao %} {{ refeicao }} {% endblock %}

{% block jsatleta %}
<script src="{{ url_for('static', filename='js/msginfomodal.js') }}"></script>
<script src="{{ url_for('static', filename='js/atleta.js') }}"></script>

{% endblock %}

{% block jsfuncs %}
<script src="{{ url_for('static', filename='js/funcs-sisnutri.js') }}"></script>
{% endblock %}



{% block jsjquery %}{% endblock %}

{% block content %}

<script>
{% if current_user.is_authenticated %}
   var idatleta={{current_user.id}};
   var totalregref = {{refeicao|length}};
   {% if refeicao|length > 0 %}
        var data_refeicao = {{refeicao|tojson}};
   {% else %}
        var data_refeicao = []
   {% endif %}
{% else %}
   var idatleta = 0;
{%endif%}
</script>
<div class="bg-primary mt-2">
    {% import 'layouts/atleta/simulator.html' as divsimulator %}
    {{ divsimulator.simulator() }}
</div>
{% if not current_user.is_authenticated %}
<div id="contentprincipal" class="container my-2">

    <div class="row d-flex justify-content-center">
        {% if tela == 'Login' or tela == 'Registrar' %}
        {% set dnone='d-none'%}
        {% endif %}
        {% if not current_user.is_authenticated %}
        <img class="img-fluid {{dnone}}" id="img-portifolio" width="800" height="450" src="{{ url_for('static', filename='/img/portifoliorgm.jpg') }}" alt="">
        {% endif %}
        <div class="col-lg-6 col-sm-12 bg-primary form-padrao">

            {% if not current_user.is_authenticated %}

                {% import 'layouts/atleta/formlogin.html' as formlogin %}
                {{ formlogin.formloginatleta(tela,result,mensagem,atletalogado) }}

                {% import 'layouts/atleta/formregistrar.html' as formregistrar %}
                {{ formregistrar.formregistraratleta(tela,result,mensagem,atletalogado) }}




            {% endif %}
        </div>

    </div>
</div>

{% endif %}

<!-- ESPAÃ‡O USUARIO  !-->
{% if current_user.is_authenticated %}

<div id="contentatleta" class="my-2">
    {% import 'layouts/atleta/menuatleta.html' as navmenuatleta %}
    {{ navmenuatleta.nav_menuatleta(current_user.name,refeicao) }}

    {% import 'layouts/atleta/divfieldempty.html' as divfieldempy %}
    {{ divfieldempy.divcheckfields_empty(atletalogado) }}

    {% import 'layouts/atleta/divdadosatleta.html' as divdadosatleta %}
    {{ divdadosatleta.divdadosatleta(atletalogado) }}

    {% import 'layouts/atleta/divrefeicoesatleta.html' as divrefeicoesatleta %}
    {{ divrefeicoesatleta.telarefeicoesatleta(refeicao,atletalogado.idpessoa) }}

    {% import 'layouts/atleta/mdinsertedit_refeicao.html' as modal_refeicao %}
    {{ modal_refeicao.modalinserteditrefeicao() }}

    {% import 'layouts/atleta/mddelete_refeicao.html' as modal_delete_refeicao %}
    {{ modal_delete_refeicao.mddeleterefeicao() }}


</div>
{% endif %}


<script>
    $().ready(function() {
        console.log(totalregref);
        if (totalregref == 0){
            console.log(data_refeicao);
            totalreg = 0;
            divrefatleta = document.getElementById('divrefatleta');
            divrefatleta.classList.remove('d-none');

        }
        else{

            divrefatleta = document.getElementById('divrefatleta');
            divrefatleta.classList.add('d-none');
            totalreg = data_refeicao.length;
        }
        verifica_table_refeicao_empty(totalreg);
    });

</script>
{% endblock %}
